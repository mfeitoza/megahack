# Migration `20200703112659-one`

This migration has been generated by Marcus Feitoza at 7/3/2020, 11:26:59 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."User" (
"address" TEXT NOT NULL  ,"city" TEXT NOT NULL  ,"company" TEXT NOT NULL  ,"email" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"state" TEXT NOT NULL  ,"zipCode" TEXT NOT NULL  ,
    PRIMARY KEY ("id"))

CREATE TABLE "quaint"."Category" (
"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"name" TEXT NOT NULL  )

CREATE TABLE "quaint"."Request" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdBy" TEXT NOT NULL  ,"description" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"responseId" TEXT   ,"title" TEXT NOT NULL  ,"validUntil" DATE NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("createdBy") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("responseId") REFERENCES "Response"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."Response" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdBy" TEXT NOT NULL  ,"description" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"title" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("createdBy") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_CategoryToRequest" (
"A" INTEGER NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Category"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Request"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "quaint"."_CategoryToRequest_AB_unique" ON "_CategoryToRequest"("A","B")

CREATE  INDEX "quaint"."_CategoryToRequest_B_index" ON "_CategoryToRequest"("B")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200703112659-one
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,54 @@
+datasource DS {
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = env("BINARY_TARGET")
+}
+
+// Define your own datamodels here and run `yarn redwood db save` to create
+// migrations for them.
+// TODO: Please remove the following example:
+model User {
+  id       String     @id @default(cuid())
+  email    String     @unique
+  name     String
+  company  String
+  zipCode  String
+  address  String
+  state    String
+  city     String
+  request  Request[]
+  response Response[]
+}
+
+model Category {
+  id      Int       @id @default(autoincrement())
+  name    String
+  request Request[] @relation(references: [id])
+}
+
+model Request {
+  id          String     @id @default(cuid())
+  title       String
+  description String
+  category    Category[] @relation(references: [id])
+  createdAt   DateTime   @default(now())
+  created     User       @relation(fields: [createdBy], references: [id])
+  createdBy   String
+  validUntil  DateTime
+  response    Response?  @relation(fields: [responseId], references: [id])
+  responseId  String?
+}
+
+model Response {
+  id          String    @id @default(cuid())
+  title       String
+  description String
+  createdAt   DateTime  @default(now())
+  created     User      @relation(fields: [createdBy], references: [id])
+  createdBy   String
+  request     Request[]
+}
```


